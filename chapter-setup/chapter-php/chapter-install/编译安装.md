# 编译安装

# 编译组件

```bash

$ yum install epel-release

# gcc 安装过则不需要
$ yum install gcc gcc-c++ autoconf pkgconfig 
```

## 常规组件

```
$ yum install pcre pcre-devel gd gd-devel gd-last libjpeg libjpeg-devel libpng libpng-devel freetype freetype-devel zlib zlib-devel glibc glibc-devel glib2 glib2-devel bzip2 bzip2-devel curl curl-devel openssl openssl-devel openldap openldap-devel nss_ldap openldap-clients openldap-servers libmcrypt libmcrypt-devel mcrypt mhash libidn libidn-devel libxml2 libxml2-devel libXpm-devel gmp-devel aspell-devel recode-devel bison re2c libicu-devel systemtap-sdt-devel sqlite sqlite-devel libdb-devel gdbm gdbm-devel enchant enchant-devel
```
- **gd gd-devel** 最新版本GD
- **bison ** git版本的PHP编译必须插件
- **systemtap-sdt-devel** `sys/sdt.h`必须组件
- **sqlite sqlite-devel**
- **gdbm gdbm-devel libdb-devel db4-devel**  DBA
    ```
    $ ln -s /usr/include/gdbm/ndbm.h /usr/include/ndbm.h
    $ ln -s /usr/lib/libgdbm.so /usr/lib/libndbm.so
    ``` 

## 其它组件

### GD 2.2

```

```

### Tokyo Cabinet

开启支持
```
--with-tcadb=/usr
```


## 创建配置文件

```bash
$ ./buildconf --force
```

## 配置

### 共享模式

常规扩展都不编译到`php`中，使用`ext`的方式加载 

比如：cUrl GD

```bash
$ ./configure --prefix=/usr \
--exec-prefix=/usr \
--bindir=/usr/bin \
--sbindir=/usr/sbin \
--sysconfdir=/etc \
--datadir=/usr/share \
--includedir=/usr/include \
--libdir=/usr/lib64 \
--libexecdir=/usr/libexec \
--localstatedir=/var \
--sharedstatedir=/var/lib \
--mandir=/usr/share/man \
--infodir=/usr/share/info \
--cache-file=../config.cache \
--with-libdir=lib64 \
--with-config-file-path=/etc \
--with-config-file-scan-dir=/etc/php.d \
--disable-debug \
--with-pic \
--disable-rpath \
--without-pear \
--with-exec-dir=/usr/bin \
--with-freetype-dir=/usr \
--with-png-dir=/usr \
--with-xpm-dir=/usr \
--enable-gd-native-ttf \
--without-gdbm \
--disable-dba \
--with-jpeg-dir=/usr \
--with-openssl \
--with-system-ciphers \
--with-zlib \
--with-layout=GNU \
--with-kerberos \
--with-libxml-dir=/usr \
--with-system-tzdata \
--with-mhash \
--enable-dtrace \
--libdir=/usr/lib64/php \
--enable-pcntl \
--enable-opcache \
--enable-opcache-file \
--disable-huge-code-pages \
--enable-phpdbg \
--with-imap=shared \
--with-imap-ssl \
--enable-mbstring=shared \
--enable-mbregex \
--with-gd=shared,/usr \
--with-gmp=shared \
--enable-calendar=shared \
--enable-bcmath=shared \
--with-bz2=shared \
--enable-ctype=shared \
--enable-dba=shared \
--with-db4=/usr \
--with-gdbm=/usr \
--enable-exif=shared \
--enable-ftp=shared \
--with-gettext=shared \
--with-iconv=shared \
--enable-sockets=shared \
--enable-tokenizer=shared \
--with-xmlrpc=shared \
--with-ldap=shared \
--with-ldap-sasl \
--enable-mysqlnd=shared \
--with-mysqli=shared,mysqlnd \
--with-mysql-sock=/var/lib/mysql/mysql.sock \
--with-oci8=shared,instantclient,/usr/lib64/oracle/12.1/client64/lib,12.1 \
--with-pdo-oci=shared,instantclient,/usr,12.1 \
--with-interbase=shared,/usr/lib64/firebird \
--with-pdo-firebird=shared,/usr/lib64/firebird \
--enable-dom=shared \
--with-pgsql=shared \
--enable-simplexml=shared \
--enable-xml=shared \
--enable-wddx=shared \
--with-snmp=shared,/usr \
--enable-soap=shared \
--with-xsl=shared,/usr \
--enable-xmlreader=shared \
--enable-xmlwriter=shared \
--with-curl=shared,/usr \
--enable-pdo=shared \
--with-pdo-odbc=shared,unixODBC,/usr \
--with-pdo-mysql=shared,mysqlnd \
--with-pdo-pgsql=shared,/usr \
--with-pdo-sqlite=shared,/usr \
--with-pdo-dblib=shared,/usr \
--with-sqlite3=shared,/usr \
--enable-json=shared \
--without-readline \
--with-libedit \
--with-pspell=shared \
--enable-phar=shared \
--with-mcrypt=shared,/usr \
--with-tidy=shared,/usr \
--enable-sysvmsg=shared \
--enable-sysvshm=shared \
--enable-sysvsem=shared \
--enable-shmop=shared \
--enable-posix=shared \
--with-unixODBC=shared,/usr \
--enable-fileinfo=shared \
--enable-intl=shared \
--with-icu-dir=/usr \
--with-enchant=shared,/usr \
--with-recode=shared,/usr
```
